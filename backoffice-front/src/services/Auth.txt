import { useState, useEffect } from 'react';
import { useHistory } from 'react-router-dom';
import Cookies from 'js-cookie';
import axios from 'axios';

const requireAuth = (Component) => {
  const AuthenticatedComponent = (props) => {
    const history = useHistory();
    const [loading, setLoading] = useState(true);
    const BASE_URL=""
    useEffect(() => {
      const accessToken = Cookies.get('accessToken');

      if (!accessToken) {
        history.push('/login');
      } else {
        // Verificar que el token siga vigente
        axios.post(`${BASE_URL}/administrativo/verify-token`, { accessToken })
          .then(() => setLoading(false))
          .catch(() => history.push('/login'));
      }
    }, [history]);

    return loading ? <p>Loading...</p> : <Component {...props} />;
  };

  return AuthenticatedComponent;
};


